<div class="animate__animated animate__fadeIn animate__faster row m-0">

    <home-view-header
    title="nueva empresa"
    [enableTourButton]="false"
    ></home-view-header> 

    <form id="newCompanyForm" enctype="multipart/form-data" #companyForm [formGroup]="form" (submit)="onSubmit(companyForm)" class="col-12 px-0 py-2 d-flex align-items-center">
        
        <div class="row m-0 justify-content-center">

            <div class="col-12 p-2 company-info-section">

                <div class="row m-0">

                    <div class="col-12 col-md-6 py-0 pl-0 pr-2">

                        <div class="row m-0">

                            <div class="col-12 p-0 mb-3">
                                <b>Empresa</b>:
                            </div>

                            <div class="col-6 px-1 mb-2">
     
                                <label class="mb-2" for="company-logo-preview">Logo de la empresa: <span class="required-mark">*</span></label>
                                
                                <div class="row mx-0 align-items-end">

                                    <div class="col-6 p-0 icon-preview-container" [ngClass]="{
                                        'bkg-dark': ! companyLogoImgSrc,
                                        'bkg-light': companyLogoImgSrc
                                    }">

                                        <img id="company-logo-preview" [class.d-none]="! companyLogoImgSrc" class="icon-preview pointer" (click)="toggleFullscreen($event)" [src]="companyLogoImgSrc" alt="icono">

                                    </div>
        
                                    <div class="col-6 pl-4 align-self-end">
                                        
                                        <label id="company-icon-upload" class="btn btn-sm btn-outline-secondary load-icon-btn rounded-lg" for="company-logo">
                                            <img class="small-icon" src="assets/icons/SVG/CARGAR.svg" alt="icono-cargar">
                                            &nbsp;
                                            Cargar imagen
                                        </label>

                                        <input 
                                        #imageInput
                                        formControlName="image"
                                        required
                                        accept=".png, .jpg, .jpeg" 
                                        class="hide"
                                        type="file" 
                                        name="image" 
                                        id="company-logo"
                                        (change)="onSelectCompanyLogo($event)">

                                    </div>
        
                                </div>
                                
                            </div>

                            <div class="col-6 px-1 mb-2">

                                <div class="row m-0">

                                    <div class="col-12 p-0 mb-2">

                                        <label class="mb-2" for="name">Nombre de la empresa: <span class="required-mark">*</span></label>
                                        
                                        <input type="text" id="name" name="name" formControlName="name" required>
                                        
                                    </div>

                                    <div class="col-12 p-0">

                                        <label class="mb-2" for="cif">CIF: <span class="required-mark">*</span></label>
                                        
                                        <input type="text" id="cif" name="cif" formControlName="cif" required>

                                    </div>

                                </div>
     
                            </div>

                            <div class="col-6 px-1 mb-2">
                            
                                <label class="mb-2" for="company-province">Ubicación: <span class="required-mark">*</span></label>

                                <ng-select
                                    id="company-province"
                                    class="custom" 
                                    name="province_id" 
                                    formControlName="province_id"
                                    required 
                                    placeholder="Seleccione provincia..."
                                    [clearable]="false"
                                    [items]="provinces"
                                    bindLabel="name"
                                    bindValue="provincia"
                                    [loading]="loadingProvinces"
                                    [loadingText]="'Cargando provincias...'"
                                    (change)="onChangeProvinceSelector($event)"
                                >
                                </ng-select>
                            </div>
                           
                            <div class="col-6 px-1 mb-2 mt-1">
                            
                                <ng-select
                                    id="company-municipality"
                                    required 
                                    formControlName="municipality_id" 
                                    name="municipality_id" 
                                    class="custom mt-4" 
                                    [clearable]="false"
                                    placeholder="Seleccione municipio..."
                                    [loading]="loadingMunicipalities"
                                    [loadingText]="'Cargando municipios...'"
                                    [items]="municipalities"
                                    bindLabel="name"
                                    bindValue="id"
                                >
                                </ng-select>

                            </div>

                            <div class="col-12 mb-2 px-0 mt-1">

                                <div class="row m-0">

                                    <div class="col-12 col-lg-6 px-0 mb-2">
                                        
                                        <label class="mb-2" for="users_per_project">Nº usuarios por proyecto:</label>

                                        <input type="number" id="users_per_project" name="users_per_project" formControlName="users_per_project">

                                    </div>

                                    <div class="col-12 col-lg-6 px-1 mb-2">
                                        
                                        <label class="mb-2" for="installers_per_project">Nº instaladores por proyecto:</label>

                                        <input type="number" id="installers_per_project" name="installers_per_project" formControlName="installers_per_project">

                                    </div>

                                    <div class="col-12 col-lg-6 px-0 mb-2">
                                        
                                        <label class="mb-2" for="max_users_number">Nº usuarios permitidos:</label>

                                        <input type="number" id="max_users_number" name="max_users_number" formControlName="max_users_number">

                                    </div>

                                </div>

                            </div>
                        </div>

                    </div>

                    <div class="left-bordered col-12 col-md-6 pl-2 pr-0">
        
                        <div formGroupName="admin_1" class="row m-0">
        
                            <div class="col-12 p-0 mb-3">
                                <b>Administrador 1</b>: <span class="required-mark">*</span>
                            </div>
    
                            <div class="col-4 px-1 mb-2">
     
                                <label class="mb-2" for="admin_1_name">Nombre: <span class="required-mark">*</span></label>
                                
                                <input type="text" id="admin_1_name" formControlName="nombre" required>
                        
                            </div>
                
                            <div class="col-4 px-1 mb-2">
                
                                <label class="mb-2" for="admin_1_last_name">Apellido: <span class="required-mark">*</span></label>
                                
                                <input type="text" id="admin_1_last_name" formControlName="apellidos" required>
                        
                            </div>
                
                            <div class="col-4 px-1 mb-2">
                
                                <label class="mb-2" for="admin_1_nif">NIF/NIE: <span class="required-mark">*</span></label>
                                
                                <input type="text" id="admin_1_nif" formControlName="nif" required>
                        
                            </div>
    
                            <div class="col-4 p-0 mb-2">
                
                                <label class="mb-2" for="admin_1_id_usuario">Nombre usuario: <span class="required-mark">*</span></label>
                                
                                <input type="text" id="admin_1_id_usuario" formControlName="id_usuario" required>
                        
                            </div>
                            
                            <div class="col-4 px-1 mb-2">
                
                                <label class="mb-2" for="admin_1_email">Email: <span class="required-mark">*</span></label>
                                
                                <input type="email" id="admin_1_email" formControlName="email" required>
                        
                            </div>
                
                            <div class="col-4 px-0 mb-2">
                
                                <label class="mb-2" for="admin_1_clave">Contraseña: <span class="required-mark">*</span></label>
                                
                                <input #passwordField type="password" id="clave" formControlName="clave" required>
                            
                                <img [src]="passwordField.type === 'password' ? 'assets/icons/visualizar.svg' : 'assets/icons/OCULTAR.svg'" 
                                    class="eye-icon pointer" 
                                    (click)="togglePasswordVisibility(passwordField)">
                            </div>
                           
                        </div>

                        <div formGroupName="admin_2" class="row m-0">
        
                            <div class="col-12 p-0 mb-3">
                                <b>Administrador 2</b>:
                            </div>
    
                            <div class="col-4 p-0 mb-2">
     
                                <label class="mb-2" for="admin_2_name">Nombre:</label>
                                
                                <input type="text" id="admin_2_name" formControlName="nombre">
                        
                            </div>
                
                            <div class="col-4 px-1 mb-2">
                
                                <label class="mb-2" for="admin_2_last_name">Apellido:</label>
                                
                                <input type="text" id="admin_2_last_name" formControlName="apellidos">
                        
                            </div>
                
                            <div class="col-4 p-0 mb-2">
                
                                <label class="mb-2" for="admin_2_nif">NIF/NIE:</label>
                                
                                <input type="text" id="admin_2_nif" formControlName="nif">
                        
                            </div>

                            <div class="col-4 p-0 mb-2">
                
                                <label class="mb-2" for="admin_2_id_usuario">Nombre usuario:</label>
                                
                                <input type="text" id="admin_2_id_usuario" formControlName="id_usuario">
                        
                            </div>
                
    
                            <div class="col-4 px-1 mb-2">
                
                                <label class="mb-2" for="admin_2_email">Email:</label>
                                
                                <input type="email" id="admin_2_email" formControlName="email">
                        
                            </div>

                            <div class="col-4 p-0 mb-2">
                
                                <label class="mb-2" for="admin_2_clave">Contraseña:</label>
                                
                                <input #passwordField type="password" id="clave" formControlName="clave">
                            
                                <img [src]="passwordField.type === 'password' ? 'assets/icons/visualizar.svg' : 'assets/icons/OCULTAR.svg'" 
                                    class="eye-icon pointer" 
                                    (click)="togglePasswordVisibility(passwordField)">
                            </div>
                            
                            
                        </div>
        
                    </div>
                   
                </div>

            </div>
           
        </div>
        
    </form>

    <div class="col-12 px-0 d-flex align-items-center justify-content-end">
        
        <div class="col-2 p-2">
            <button type="submit" form="newCompanyForm" [disabled]="form.invalid" class="btn btn-block btn-info p-1">
                Crear
            </button>
        </div>

        <div class="col-2 pl-2 pr-0">
            <a [routerLink]="['../']" class="btn btn-block btn-outline-info p-1">
                Volver
            </a>
        </div>
    </div>


</div>

